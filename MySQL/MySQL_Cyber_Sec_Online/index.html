<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documenta√ß√£o: Introdu√ß√£o ao Banco de Dados</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>üìò Documenta√ß√£o: Introdu√ß√£o ao Banco de Dados</h1>
    <p>Esta documenta√ß√£o descreve as etapas para criar e configurar um banco de dados intermedi√°rio, com suporte a login, utilizando MySQL, PHP e HTML.</p>
    
    <h2>1Ô∏è‚É£ Estrutura do Banco de Dados</h2>
    <p>Primeiro, vamos criar um banco de dados que contemple:</p>
    <ul>
        <li>Tabela para <b>usu√°rios</b> com os campos necess√°rios.</li>
        <li>Tabela para <b>progresso</b> do usu√°rio nos t√≥picos.</li>
    </ul>

<section>    
    <h3>SQL para o Banco de Dados</h3>
    <pre><code>
CREATE DATABASE CyberSecOnline;

USE CyberSecOnline;

-- Tabela de Usu√°rios
CREATE TABLE usuarios (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nome_usuario VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    senha_hash VARCHAR(255) NOT NULL,
    data_criacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabela de Progresso
CREATE TABLE progresso (
    id INT AUTO_INCREMENT PRIMARY KEY,
    usuario_id INT NOT NULL,
    topico_id INT NOT NULL,
    concluido BOOLEAN DEFAULT FALSE,
    FOREIGN KEY (usuario_id) REFERENCES usuarios(id)
);

-- Tabela de T√≥picos (para refer√™ncia dos conte√∫dos)
CREATE TABLE topicos (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nome_topico VARCHAR(100) NOT NULL,
    descricao TEXT,
    ordem INT UNIQUE NOT NULL
);

-- Inserir t√≥picos iniciais
INSERT INTO topicos (nome_topico, descricao, ordem) VALUES
('Introdu√ß√£o √† Ciberseguran√ßa', 'Conceitos b√°sicos sobre seguran√ßa digital.', 1),
('Introdu√ß√£o ao Kali Linux', 'Princ√≠pios b√°sicos e ferramentas.', 2),
('Ferramentas de Hacking', 'Principais ferramentas e seu uso.', 3);

    </code></pre>
</section>
    
<section>
    <h2>2Ô∏è‚É£ Atualizar Formul√°rio de Criar Conta</h2>
    <p>Vamos criar um script PHP para registrar o usu√°rio no banco de dados.</p>
    <h3>Arquivo: criar_conta.php</h3>
    <pre>
&lt;<?php
session_start();
include 'conexao.php';

if ($_SERVER["REQUEST_METHOD"] == "POST") {
    $nome_usuario = $_POST['nome_usuario'];
    $email = $_POST['email'];
    $senha = $_POST['senha'];
    $confirmar_senha = $_POST['confirmar_senha'];

    if ($senha !== $confirmar_senha) {
        die("Erro: As senhas n√£o coincidem!");
    }

    $senha_hash = hash("sha256", $senha);

    $sql = "INSERT INTO usuarios (nome_usuario, email, senha_hash) VALUES (?, ?, ?)";
    $stmt = $conn->prepare($sql);
    $stmt->bind_param("sss", $nome_usuario, $email, $senha_hash);

    if ($stmt->execute()) {
        echo "Conta criada com sucesso! Agora voc√™ pode fazer login.";
    } else {
        echo "Erro ao criar conta: " . $stmt->error;
    }
}
?>&gt;
    </pre>
</section>
 
<section>   
    <h2>3Ô∏è‚É£ Atualizar Formul√°rio de Login</h2>
    <p>Adicione a funcionalidade para verificar as credenciais e carregar o progresso do usu√°rio.</p>
    <h3>Arquivo: login.php</h3>
    <pre><code>
&lt;<?php
session_start();
include 'conexao.php';

if ($_SERVER["REQUEST_METHOD"] == "POST") {
    $login = $_POST['login'];
    $senha = $_POST['senha'];

    $sql = "SELECT * FROM usuarios WHERE email = ? OR nome_usuario = ?";
    $stmt = $conn->prepare($sql);
    $stmt->bind_param("ss", $login, $login);
    $stmt->execute();
    $resultado = $stmt->get_result();

    if ($resultado->num_rows > 0) {
        $usuario = $resultado->fetch_assoc();
        $senha_hash = hash("sha256", $senha);

        if ($senha_hash === $usuario['senha_hash']) {
            $_SESSION['usuario'] = $usuario['id'];
            echo "Login bem-sucedido! Bem-vindo, " . $usuario['nome_usuario'];
        } else {
            echo "Senha incorreta.";
        }
    } else {
        echo "Usu√°rio ou e-mail n√£o encontrado.";
    }
}
?>&gt;
   </code></pre> 
</section>

<section> 
    <h2>4 Progresso do Usu√°rio</h2>
    <p>Ap√≥s o login, carregamos os t√≥picos e o progresso:</P>
    <h3>Arquivo: dashboard.php</h3>
    <pre><code>
&lt;?php
// Inicia a sess√£o para manter o estado do usu√°rio logado
session_start();

// Inclui o arquivo de conex√£o com o banco de dados
include 'conexao.php';

// Verifica se o usu√°rio est√° logado, caso contr√°rio, exibe uma mensagem de acesso negado
if (!isset($_SESSION['usuario'])) {
    die("Acesso negado");
}

// Obt√©m o ID do usu√°rio logado
$usuario_id = $_SESSION['usuario'];

// Consulta SQL para buscar os t√≥picos e o progresso do usu√°rio
$sql = "SELECT t.nome_topico, p.concluido
        FROM topicos t
        LEFT JOIN progresso p ON t.id = p.topico_id AND p.usuario_id = ?";

// Prepara a consulta para evitar SQL Injection
$stmt = $conn-&gt;prepare($sql);

// Associa o ID do usu√°rio como par√¢metro na consulta
$stmt-&gt;bind_param("i", $usuario_id);

// Executa a consulta
$stmt-&gt;execute();

// Obt√©m o resultado da consulta
$resultado = $stmt-&gt;get_result();

// Loop para exibir os t√≥picos e o status de conclus√£o do usu√°rio
while ($topico = $resultado-&gt;fetch_assoc()) {
    echo $topico['nome_topico'] . " - " . ($topico['concluido'] ? "Conclu√≠do" : "Pendente") . "&lt;br&gt;";
}
?&gt;
  </code></pre>

<h2>Explica√ß√£o do C√≥digo</h2>
<p>O c√≥digo abaixo gerencia o progresso do usu√°rio nos t√≥picos de aprendizado ap√≥s o login.</p>

<ul>
    <li><strong>Sess√£o:</strong> A sess√£o √© iniciada com <code>session_start()</code> para manter o estado do usu√°rio logado.</li>
    <li><strong>Conex√£o com o banco de dados:</strong> O arquivo <code>conexao.php</code> √© inclu√≠do para estabelecer a conex√£o com o banco.</li>
    <li><strong>Verifica√ß√£o de login:</strong> Se o usu√°rio n√£o estiver logado (<code>$_SESSION['usuario']</code> n√£o existir), a execu√ß√£o √© interrompida com a mensagem <code>"Acesso negado"</code>.</li>
    <li><strong>Consulta SQL:</strong> A consulta busca os t√≥picos e o progresso do usu√°rio na tabela <code>progresso</code>, usando <code>LEFT JOIN</code> para garantir que todos os t√≥picos sejam retornados, mesmo se o progresso n√£o existir.</li>
    <li><strong>Prepara√ß√£o da consulta:</strong> O <code>prepare()</code> √© usado para evitar SQL Injection.</li>
    <li><strong>Execu√ß√£o e Exibi√ß√£o dos dados:</strong> A consulta √© executada e um loop exibe cada t√≥pico, indicando se est√° <code>"Conclu√≠do"</code> ou <code>"Pendente"</code>, dependendo do status na tabela de progresso.</li>
</ul>

<p>Esse c√≥digo permite acompanhar o progresso de um usu√°rio nos t√≥picos de aprendizado.</p>

    </code></pre>
</section>

<section>    
    <h2>4Ô∏è‚É£ C√≥digo de Conex√£o ao Banco de Dados</h2>
    <h3>Arquivo: conexao.php</h3>
    <pre><code>
<pre><code>
&lt;?php
// Configura√ß√µes de conex√£o com o banco de dados
$host = "localhost"; // Endere√ßo do servidor
$usuario = "root";   // Usu√°rio que acessar√° o MySQL
$senha = "";         // Senha do MySQL (adicione aqui se necess√°rio)
$banco = "cyberseconline"; // Nome do banco de dados

// Criar conex√£o
$conn = new mysqli($host, $usuario, $senha, $banco);

// Verificar conex√£o
if ($conn-&gt;connect_error) {
    die("Falha na conex√£o: " . $conn-&gt;connect_error);
}
?&gt;
</code></pre>

<h2>Explica√ß√£o do C√≥digo</h2>

<ul>
    <li><strong>Configura√ß√£o das Vari√°veis:</strong>
        <ul>
            <li><code>$host</code>: Define o endere√ßo do servidor MySQL. Para ambiente local, geralmente √© <code>localhost</code>.</li>
             <li><code>$usuario</code>: Usu√°rio que acessar√° o MySQL, normalmente <code>root</code> em servidores locais.</li>
            <li><code>$senha</code>: A senha do usu√°rio MySQL. Se voc√™ configurou uma senha para <code>root</code>, insira aqui.</li>
            <li><code>$banco</code>: Nome do banco de dados criado (neste caso, <code>"cyberseconline"</code>).</li>
        </ul>
    </li>
    <li><strong>Cria√ß√£o da Conex√£o:</strong>
        <p>Usamos <code>new mysqli</code> para criar a conex√£o com os par√¢metros definidos.</p>
    </li>
    <li><strong>Verifica√ß√£o da Conex√£o:</strong>
        <p>Caso a conex√£o falhe, o c√≥digo para a execu√ß√£o e exibe a mensagem de erro com <code>die()</code>.</p>
    </li>
</ul>
</section>
    
<section>
    <h2>5Ô∏è‚É£ Ajuste de JavaScript</h2>
    <pre>
        <code>
// Fun√ß√£o para exibir o modal de login
function showLogin() {
    document.getElementById("loginModal").style.display = "block";
}

// Fun√ß√£o para exibir o modal de criar conta
function showCreateAccount() {
    document.getElementById("createAccountModal").style.display = "block";
}

// Fun√ß√£o para fechar qualquer modal
function closeModal(modalId) {
    document.getElementById(modalId).style.display = "none";
}

// Fechar modais ao clicar fora deles
window.onclick = function (event) {
    const loginModal = document.getElementById("loginModal");
    const createAccountModal = document.getElementById("createAccountModal");
    if (event.target === loginModal) {
        loginModal.style.display = "none";
    } else if (event.target === createAccountModal) {
        createAccountModal.style.display = "none";
    }
};

// Valida√ß√£o e envio do formul√°rio de login
document.getElementById("loginForm").addEventListener("submit", async function (event) {
    event.preventDefault(); // Impede o envio padr√£o do formul√°rio

    const login = document.getElementById("emailLogin").value.trim();
    const password = document.getElementById("passwordLogin").value.trim();

    let isValid = true;

    // Verifica√ß√£o b√°sica
    if (login === "") {
        alert("Por favor, insira seu e-mail ou nome de usu√°rio.");
        isValid = false;
    }

    if (password.length < 6) {
        alert("A senha deve ter no m√≠nimo 6 caracteres.");
        isValid = false;
    }

    if (isValid) {
        // Envia os dados para o backend usando FormData
        const formData = new FormData();
        formData.append("login", login);
        formData.append("senha", password);

        try {
            const response = await fetch("login.php", {
                method: "POST",
                body: formData,
            });

            const data = await response.text(); // Backend retorna texto

            if (data.includes("Login bem-sucedido")) {
                alert(data);
                // Redirecionar ou executar outra a√ß√£o
            } else {
                alert(data); // Exibe erros como senha incorreta ou usu√°rio n√£o encontrado
            }
        } catch (error) {
            console.error("Erro na conex√£o com o backend:", error);
            alert("Erro de conex√£o. Tente novamente mais tarde.");
        }
    }
});

// Valida√ß√£o e envio do formul√°rio de cria√ß√£o de conta
document.getElementById("registerForm").addEventListener("submit", async function (event) {
    event.preventDefault(); // Impede o envio padr√£o do formul√°rio

    const email = document.getElementById("emailCreate").value.trim();
    const username = document.getElementById("usernameCreate").value.trim();
    const password = document.getElementById("passwordCreate").value.trim();
    const confirmPassword = document.getElementById("confirmPasswordCreate").value.trim();

    let isValid = true;

    // Valida√ß√£o do e-mail
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
        alert("Por favor, insira um e-mail v√°lido.");
        isValid = false;
    }

    if (username.length === 0) {
        alert("O nome de usu√°rio √© obrigat√≥rio.");
        isValid = false;
    }

    if (password.length < 6) {
        alert("A senha deve ter no m√≠nimo 6 caracteres.");
        isValid = false;
    }

    if (password !== confirmPassword) {
        alert("As senhas n√£o coincidem.");
        isValid = false;
    }

    if (isValid) {
        // Envia os dados para o backend usando FormData
        const formData = new FormData();
        formData.append("nome_usuario", username);
        formData.append("email", email);
        formData.append("senha", password);
        formData.append("confirmar_senha", confirmPassword);

        try {
            const response = await fetch("criar_conta.php", {
                method: "POST",
                body: formData,
            });

            const data = await response.text(); // Backend retorna texto

            if (data.includes("Conta criada com sucesso")) {
                alert(data);
                // Redirecionar ou executar outra a√ß√£o
            } else {
                alert(data); // Exibe erros como senhas n√£o coincidem
            }
        } catch (error) {
            console.error("Erro na conex√£o com o backend:", error);
            alert("Erro de conex√£o. Tente novamente mais tarde.");
        }
    }
});

// Fun√ß√£o para alternar a visibilidade da senha
function togglePassword(inputId) {
    const input = document.getElementById(inputId);
    input.type = input.type === "password" ? "text" : "password";
}
        </code>
    </pre>
</section>
    
    <footer>
        <p>&copy; 2025 Guia SQL. Todos os direitos reservados.</p>
    </footer>
</body>
</html>
